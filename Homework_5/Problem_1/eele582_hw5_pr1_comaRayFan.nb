(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49767,       1391]
NotebookOptionsPosition[     45766,       1246]
NotebookOutlinePosition[     46149,       1262]
CellTagsIndexPosition[     46106,       1259]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
EELE 582 Optical Design
Homework 5
Roy Smart\
\>", "Chapter",
 CellChangeTimes->{{3.696949620930559*^9, 3.6969496248216343`*^9}}],

Cell[CellGroupData[{

Cell["Problem 1", "Section",
 CellChangeTimes->{{3.6968773973731403`*^9, 3.696877439901137*^9}, {
  3.6968775653082185`*^9, 3.696877571140272*^9}, {3.696949632769726*^9, 
  3.696949635295247*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.6968794845593867`*^9, 3.6968794845793524`*^9}}],

Cell[CellGroupData[{

Cell["Third-order coma is given by the expression", "Subsubsection",
 CellChangeTimes->{{3.6968775847118945`*^9, 3.69687761069562*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Wc", " ", "=", " ", 
   RowBox[{"W131", " ", "H", " ", 
    SuperscriptBox["\[Rho]", "3"], 
    RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6968776123307705`*^9, 3.6968776176187124`*^9}, {
  3.696877688676459*^9, 3.6968777075356407`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The transverse ray aberration is found using the relation", \
"Subsubsection",
 CellChangeTimes->{{3.6968777267155647`*^9, 3.6968777450849156`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p2c", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Rho]", "\[Rule]", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}]]}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", " ", 
      RowBox[{"ArcTan", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c2p", " ", "=", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", " ", 
      RowBox[{"\[Rho]", " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
     RowBox[{"y", "\[Rule]", " ", 
      RowBox[{"\[Rho]", " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}]}], "}"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "[", "W_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       FractionBox["R", 
        RowBox[{"n", " ", "r"}]], ")"}]}], 
     RowBox[{"Grad", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"W", " ", "/.", " ", "p2c"}], ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], " ", "/.", " ", "c2p"}], 
   " ", "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.6968777636734104`*^9, 3.6968777970959597`*^9}, {
  3.6969030244068403`*^9, 3.696903029007742*^9}, {3.696949769715358*^9, 
  3.696949780641676*^9}, {3.6969498508223753`*^9, 3.696949856385354*^9}, {
  3.696949902708802*^9, 3.696949913507311*^9}, {3.696949997218124*^9, 
  3.696950006427436*^9}, {3.6969503587840147`*^9, 3.696950360326745*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Plug our expression for coma into the transverse ray aberration function\
\>", "Subsubsection",
 CellChangeTimes->{{3.6968780693301105`*^9, 3.6968780895023513`*^9}, {
  3.696949798248254*^9, 3.696949798404134*^9}, {3.696949858649454*^9, 
  3.696949858764402*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Tc", "[", 
     RowBox[{"\[Rho]_", ",", "\[Phi]_"}], "]"}], " ", "=", " ", 
    RowBox[{"T", "[", "Wc", "]"}]}], ")"}], " ", "//", "Framed"}]], "Input",
 CellChangeTimes->{{3.6968780922025003`*^9, 3.6968780940729523`*^9}, {
   3.696878145104699*^9, 3.696878160324812*^9}, {3.6968782084631968`*^9, 
   3.6968782109482293`*^9}, 3.696903040380868*^9, {3.6969500156045227`*^9, 
   3.696950063490096*^9}, {3.6969501033964567`*^9, 3.696950107425386*^9}, {
   3.6969503654202547`*^9, 3.6969503655296907`*^9}}],

Cell[BoxData[
 FrameBox[
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     RowBox[{"H", " ", "R", " ", "W131", " ", 
      SuperscriptBox["\[Rho]", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}]}], ")"}]}], 
     RowBox[{"n", " ", "r"}]], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", "H", " ", "R", " ", "W131", " ", 
       SuperscriptBox["\[Rho]", "2"], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
      RowBox[{"n", " ", "r"}]]}]}], "}"}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{
  3.6968780942848806`*^9, {3.6968781495831785`*^9, 3.6968781606923704`*^9}, 
   3.696878211714357*^9, 3.6968797015179243`*^9, 3.6969025144930696`*^9, 
   3.696903043127019*^9, 3.696903326608494*^9, 3.696903371040675*^9, 
   3.6969040917055187`*^9, 3.696904955119953*^9, 3.696905195097128*^9, 
   3.6969053610434933`*^9, 3.696905500572407*^9, {3.6969062858252487`*^9, 
   3.6969063053578053`*^9}, 3.696907378698731*^9, {3.6969495174638453`*^9, 
   3.696949530737911*^9}, 3.696949874963771*^9, 3.696949916587102*^9, {
   3.6969500184593897`*^9, 3.696950034219117*^9}, {3.696950089965906*^9, 
   3.696950107638159*^9}, 3.696950372139964*^9, 3.696965938853705*^9, 
   3.696966605048671*^9, {3.696966684974798*^9, 3.6969666963333893`*^9}, 
   3.696971078209976*^9, 3.6969712072250757`*^9, 3.6969713332895393`*^9, 
   3.696971372743437*^9, 3.6969829453360443`*^9, 3.6969829926338696`*^9, {
   3.6969830246395764`*^9, 3.6969830529978685`*^9}, 3.6969834509403105`*^9, {
   3.6969834845576015`*^9, 3.696983499684504*^9}, 3.6969837423802943`*^9, 
   3.696983976508133*^9, 3.696984734770297*^9, {3.6969848267491503`*^9, 
   3.696984851633089*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Create list of pupil points in polar coordinates", "Subsubsection",
 CellChangeTimes->{{3.696878870169086*^9, 3.696878893798602*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"P\[Rho]", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "R", ",", "R", ",", "R", ",", "R", ",", "R", ",", "R", ",", "R", ",", "R",
      ",", 
     RowBox[{"a", " ", "R"}], ",", 
     RowBox[{"a", " ", "R"}], ",", 
     RowBox[{"a", " ", "R"}], ",", 
     RowBox[{"a", " ", "R"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P\[Phi]", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0", 
      RowBox[{"\[Pi]", "/", "4"}]}], ",", 
     RowBox[{"1", 
      RowBox[{"\[Pi]", "/", "4"}]}], ",", 
     RowBox[{"2", 
      RowBox[{"\[Pi]", "/", "4"}]}], ",", 
     RowBox[{"3", 
      RowBox[{"\[Pi]", "/", "4"}]}], ",", 
     RowBox[{"4", 
      RowBox[{"\[Pi]", "/", "4"}]}], ",", 
     RowBox[{"5", 
      RowBox[{"\[Pi]", "/", "4"}]}], ",", 
     RowBox[{"6", 
      RowBox[{"\[Pi]", "/", "4"}]}], ",", 
     RowBox[{"7", 
      RowBox[{"\[Pi]", "/", "4"}]}], ",", 
     RowBox[{"\[Pi]", "/", "4"}], ",", 
     RowBox[{"3", 
      RowBox[{"\[Pi]", "/", "4"}]}], ",", 
     RowBox[{"5", 
      RowBox[{"\[Pi]", "/", "4"}]}], ",", 
     RowBox[{"7", 
      RowBox[{"\[Pi]", "/", "4"}]}], ",", 
     RowBox[{"0", 
      RowBox[{"\[Pi]", "/", "4"}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.696879450075816*^9, 3.6968794539581456`*^9}, {
  3.696879496155276*^9, 3.696879663571781*^9}, {3.696907365673564*^9, 
  3.696907368290317*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pts", "=", 
   RowBox[{"{", 
    RowBox[{"P\[Phi]", ",", "P\[Rho]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ptsT", " ", "=", " ", 
  RowBox[{"Transpose", "[", "pts", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ListPolarPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"N", "[", "ptsT", "]"}], " ", "/.", " ", 
     RowBox[{"R", "\[Rule]", " ", "1"}]}], " ", "/.", " ", 
    RowBox[{"a", "\[Rule]", " ", "0.7"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"PointSize", "[", "Large", "]"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6969839049314985`*^9, 3.696983966275976*^9}, {
  3.6969840873493977`*^9, 3.6969841321037626`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "R"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["\[Pi]", "4"], ",", "R"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["\[Pi]", "2"], ",", "R"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"3", " ", "\[Pi]"}], "4"], ",", "R"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Pi]", ",", "R"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"5", " ", "\[Pi]"}], "4"], ",", "R"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"3", " ", "\[Pi]"}], "2"], ",", "R"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"7", " ", "\[Pi]"}], "4"], ",", "R"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["\[Pi]", "4"], ",", 
     RowBox[{"a", " ", "R"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"3", " ", "\[Pi]"}], "4"], ",", 
     RowBox[{"a", " ", "R"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"5", " ", "\[Pi]"}], "4"], ",", 
     RowBox[{"a", " ", "R"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"7", " ", "\[Pi]"}], "4"], ",", 
     RowBox[{"a", " ", "R"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.696983928547971*^9, 3.696983976523755*^9}, 
   3.6969840956803207`*^9, 3.6969841333062873`*^9, 3.696984734790293*^9, {
   3.696984826769149*^9, 3.6969848516570888`*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {}}, {}, {{}, GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGCQAmIQDQEf7GGss9b1afMWPLOH0ewxIsZqyybawNSdgYjv
h8lDxfdD1C20OQeVh6nj6prnY1m5ag9M3WmoPpi6oLd1/avW3reH0QEQGi4e
DOXDxP3RxBmwguHjHwD5nraa
     "], {{}, 
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[Large], 
       AbsoluteThickness[1.6], 
       PointBox[{14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 
        26}]}, {}}], {}, {}, {{}, {}}}, {}, {}, {{}, {}}, {}, {{{}, {}, {}, \
{}}, {}}},
  AspectRatio->1,
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0.},
  CoordinatesToolOptions:>{"DisplayFunction" -> ({
      Sqrt[Part[#, 1]^2 + Part[#, 2]^2], 
      Mod[
       ArcTan[
        Part[#, 1], 
        Part[#, 2]], 2 Pi]}& ), "CopiedValueFunction" -> ({
      Sqrt[Part[#, 1]^2 + Part[#, 2]^2], 
      Mod[
       ArcTan[
        Part[#, 1], 
        Part[#, 2]], 2 Pi]}& )},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{Automatic, Automatic}, {Automatic, Automatic}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.02]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.696983928547971*^9, 3.696983976523755*^9}, 
   3.6969840956803207`*^9, 3.6969841333062873`*^9, 3.696984734790293*^9, {
   3.696984826769149*^9, 3.696984851697139*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Evaluate our expression for 3rd-order coma at each point in the pupil\
\>", "Subsubsection",
 CellChangeTimes->{{3.696948128138035*^9, 3.696948173988409*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pts", "=", 
   RowBox[{
    RowBox[{"Tc", "[", 
     RowBox[{"P\[Rho]", ",", "P\[Phi]"}], "]"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"H", " ", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"R", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"W131", "\[Rule]", " ", "1"}], ",", 
      RowBox[{"r", "\[Rule]", "1"}], ",", " ", 
      RowBox[{"n", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"a", "\[Rule]", " ", "0.7"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptsT", " ", "=", " ", 
   RowBox[{"Transpose", "[", "pts", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"ptsT", ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"PointSize", "[", "Large", "]"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", 
    RowBox[{"1", "/", "3"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.696879707892838*^9, 3.6968797148248873`*^9}, {
   3.696903092156954*^9, 3.696903147940696*^9}, {3.69690318664925*^9, 
   3.696903190934792*^9}, 3.696907370926317*^9, {3.696966431246517*^9, 
   3.69696643564305*^9}, 3.696966819820834*^9, {3.69696685919178*^9, 
   3.696966901237524*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[Large], 
     AbsoluteThickness[1.6], 
     PointBox[{{-1., 0.}, {-2., -1.}, {-3., 0.}, {-2., 1.}, {-1., 
      0.}, {-2., -1.}, {-3., 0.}, {-2., 
      1.}, {-0.9799999999999999, -0.48999999999999994`}, {-0.9799999999999999,
       0.48999999999999994`}, {-0.9799999999999999, -0.48999999999999994`}, \
{-0.9799999999999999, 0.48999999999999994`}, {0., 
      0.}}]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[
    Rational[1, 3], 0.3333333333333333],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{-3., 0}, {-1., 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.696966442173204*^9, 3.696966605163121*^9, {3.696966685098872*^9, 
   3.6969666964580584`*^9}, 3.69696682131565*^9, {3.696966860812419*^9, 
   3.69696690137949*^9}, 3.696971078337474*^9, 3.696971207399111*^9, 
   3.6969713334374866`*^9, 3.6969713728760357`*^9, 3.696982945436328*^9, 
   3.6969829926877627`*^9, {3.6969830246708307`*^9, 3.6969830530290937`*^9}, 
   3.6969834509871902`*^9, {3.696983484610923*^9, 3.6969834997222834`*^9}, 
   3.6969837424132366`*^9, 3.6969839766087627`*^9, 3.6969847349068356`*^9, {
   3.696984826877144*^9, 3.69698485174914*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Problem 2", "Section",
 CellChangeTimes->{{3.696949651363851*^9, 3.696949653759386*^9}}],

Cell[CellGroupData[{

Cell["Enter in the expression for defocus wavefront aberration", \
"Subsubsection",
 CellChangeTimes->{{3.696948252924871*^9, 3.696948276336039*^9}, {
  3.69694920964133*^9, 3.696949213796426*^9}, {3.696949277225356*^9, 
  3.6969492945519733`*^9}, {3.696950193563386*^9, 3.696950200686719*^9}, {
  3.696965566656929*^9, 3.696965568035534*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Wdf", " ", "=", " ", 
   RowBox[{"W020", " ", 
    SuperscriptBox["\[Rho]", "2"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.696949424328418*^9, 3.696949459901832*^9}, 
   3.696949537233371*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find the defocus transverse ray aberration", "Subsubsection",
 CellChangeTimes->{{3.696950321889213*^9, 3.696950330054145*^9}, {
  3.696965558803052*^9, 3.6969655893968*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Tdf", "[", 
   RowBox[{"\[Rho]_", ",", "\[Phi]_"}], "]"}], " ", "=", " ", 
  RowBox[{"T", "[", "Wdf", "]"}]}]], "Input",
 CellChangeTimes->{{3.6969501249945173`*^9, 3.696950163822671*^9}, {
  3.696965914966324*^9, 3.696965920934772*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", "R", " ", "W020", " ", "\[Rho]", " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
     RowBox[{"n", " ", "r"}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", "R", " ", "W020", " ", "\[Rho]", " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], 
     RowBox[{"n", " ", "r"}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.696950164285725*^9, 3.696950372445548*^9, 3.696965939128763*^9, 
   3.696966605306699*^9, {3.69696668525976*^9, 3.6969666966320744`*^9}, 
   3.696971078502214*^9, 3.696971207581542*^9, 3.696971333569112*^9, 
   3.696971373018523*^9, 3.696982945536645*^9, 3.696982992703369*^9, {
   3.6969830247021103`*^9, 3.696983053062855*^9}, 3.696983451018444*^9, {
   3.696983484642177*^9, 3.696983499753538*^9}, 3.6969837424288635`*^9, 
   3.6969839766400414`*^9, 3.696984734931777*^9, {3.6969848268971434`*^9, 
   3.69698485177314*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Part a", "Subsection",
 CellChangeTimes->{{3.696949551598218*^9, 3.696949552474859*^9}}],

Cell[CellGroupData[{

Cell["Enter the expression for spherical wavefront aberration", \
"Subsubsection",
 CellChangeTimes->{{3.696950180873413*^9, 3.696950189048427*^9}, {
  3.696950246551496*^9, 3.696950254210952*^9}, {3.6969655985994596`*^9, 
  3.696965600508326*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ws", " ", "=", " ", 
   RowBox[{"W040", " ", 
    SuperscriptBox["\[Rho]", "4"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.696950257345488*^9, 3.6969502815527153`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find the spherical transverse ray aberration", "Subsubsection",
 CellChangeTimes->{{3.6969503458175364`*^9, 3.696950352803473*^9}, {
  3.6969656054706497`*^9, 3.696965608222396*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ts", "[", 
   RowBox[{"\[Rho]_", ",", "\[Phi]_"}], "]"}], " ", "=", " ", 
  RowBox[{"T", "[", "Ws", "]"}]}]], "Input",
 CellChangeTimes->{{3.696950284767311*^9, 3.6969503032243032`*^9}, {
   3.696950370001927*^9, 3.696950370110496*^9}, 3.696965936662187*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"4", " ", "R", " ", "W040", " ", 
      SuperscriptBox["\[Rho]", "3"], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
     RowBox[{"n", " ", "r"}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"4", " ", "R", " ", "W040", " ", 
      SuperscriptBox["\[Rho]", "3"], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], 
     RowBox[{"n", " ", "r"}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.696950289329509*^9, 3.696950303504669*^9}, 
   3.696950372629233*^9, 3.696965939277649*^9, 3.69696660543895*^9, {
   3.696966685388742*^9, 3.6969666967601433`*^9}, 3.696971078670307*^9, 
   3.696971207757944*^9, 3.696971333728374*^9, 3.6969713732138577`*^9, 
   3.696982945621317*^9, 3.6969829927190223`*^9, {3.6969830247242937`*^9, 
   3.696983053066365*^9}, 3.69698345104012*^9, {3.696983484657802*^9, 
   3.6969834997691946`*^9}, 3.696983742460117*^9, 3.6969839766556416`*^9, 
   3.696984734946762*^9, {3.6969848269171705`*^9, 3.6969848517971635`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Solve for where the sum of the spherical and defocus transverse ray \
aberration is zero\
\>", "Subsubsection",
 CellChangeTimes->{{3.696966288251134*^9, 3.696966316093369*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TpA", "[", 
    RowBox[{"\[Rho]_", ",", "\[Phi]_"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"Tdf", "[", 
     RowBox[{"\[Rho]", ",", "\[Phi]"}], "]"}], " ", "+", " ", 
    RowBox[{"Ts", "[", 
     RowBox[{"\[Rho]", ",", "\[Phi]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.696966482582143*^9, 3.696966565240592*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SpA", " ", "=", " ", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"TpA", "[", 
       RowBox[{"0.7", ",", "0"}], "]"}], " ", "\[Equal]", " ", "0"}], ",", 
     " ", "W020"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.696966318723816*^9, 3.6969663909390078`*^9}, {
  3.696966589544619*^9, 3.696966594941884*^9}, {3.696966922339172*^9, 
  3.696966924693787*^9}, {3.696971146890429*^9, 3.6969711522831182`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpA", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "1"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"W020", "\[Rule]", 
  RowBox[{
   RowBox[{"-", "0.9799999999999998`"}], " ", "W040"}]}]], "Output",
 CellChangeTimes->{
  3.696971240090351*^9, 3.6969713339057837`*^9, 3.696971373361484*^9, 
   3.696982945636945*^9, 3.696982992750252*^9, {3.696983024755546*^9, 
   3.6969830531132793`*^9}, 3.69698345107139*^9, {3.6969834846955795`*^9, 
   3.696983499816047*^9}, 3.696983742497751*^9, 3.6969839766934476`*^9, 
   3.696984734982766*^9, {3.6969848269451036`*^9, 3.696984851833167*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pts", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"TpA", "[", 
      RowBox[{"P\[Rho]", ",", "P\[Phi]"}], "]"}], " ", "/.", " ", 
     RowBox[{"SpA", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"H", " ", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"R", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"W040", "\[Rule]", " ", "1"}], ",", 
      RowBox[{"r", "\[Rule]", "1"}], ",", " ", 
      RowBox[{"n", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"a", "\[Rule]", " ", "0.7"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptsT", " ", "=", " ", 
   RowBox[{"Transpose", "[", "pts", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"ptsT", ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"PointSize", "[", "Large", "]"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.696879707892838*^9, 3.6968797148248873`*^9}, {
   3.696903092156954*^9, 3.696903147940696*^9}, {3.69690318664925*^9, 
   3.696903190934792*^9}, 3.696907370926317*^9, {3.696966431246517*^9, 
   3.69696643564305*^9}, {3.696966600180306*^9, 3.696966627195345*^9}, 
   3.6969667339983788`*^9, {3.69696680531546*^9, 3.696966808948587*^9}, {
   3.696971157828033*^9, 3.6969711606693363`*^9}, {3.696971216344433*^9, 
   3.696971272248547*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[Large], 
     AbsoluteThickness[1.6], 
     PointBox[{{
      0., -2.0400000000000005`}, {-1.4424978336205574`, \
-1.4424978336205574`}, {-2.0400000000000005`, 0.}, {-1.4424978336205574`, 
      1.4424978336205574`}, {0., 2.0400000000000005`}, {1.4424978336205574`, 
      1.4424978336205574`}, {2.0400000000000005`, 0.}, {
      1.4424978336205574`, -1.4424978336205574`}, {0., 0.}, {0., 0.}, {0., 
      0.}, {0., 0.}, {0., 0.}}]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->1,
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{-2.0400000000000005`, 
   2.0400000000000005`}, {-2.0400000000000005`, 2.0400000000000005`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.69696660568458*^9, 3.6969666310397377`*^9}, {
   3.6969666857864037`*^9, 3.6969666971483088`*^9}, 3.696966734413102*^9, 
   3.696966809398321*^9, 3.696971079052392*^9, {3.696971207939929*^9, 
   3.696971224457398*^9}, {3.6969712637358637`*^9, 3.696971272793988*^9}, 
   3.6969713340680113`*^9, 3.696971373523427*^9, 3.696982945668198*^9, 
   3.6969829927876387`*^9, {3.6969830247868013`*^9, 3.696983053144533*^9}, 
   3.6969834511182847`*^9, {3.6969834847424626`*^9, 3.6969834998535414`*^9}, 
   3.69698374254463*^9, 3.696983976724728*^9, 3.696984735034877*^9, {
   3.696984826997108*^9, 3.6969848518955617`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Part b.", "Subsection",
 CellChangeTimes->{{3.696969145589902*^9, 3.696969147008939*^9}}],

Cell[CellGroupData[{

Cell["Enter the expression for astigmatic wavefront aberration", \
"Subsubsection",
 CellChangeTimes->{{3.696969156255951*^9, 3.696969168911977*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Wa", " ", "=", " ", 
   RowBox[{"W422", " ", 
    SuperscriptBox["H", "4"], " ", 
    SuperscriptBox["\[Rho]", "2"], 
    SuperscriptBox[
     RowBox[{"Cos", "[", "\[Phi]", "]"}], "2"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6969694022815742`*^9, 3.696969404309683*^9}, {
  3.696969558161207*^9, 3.696969558195215*^9}, {3.6969698054860497`*^9, 
  3.696969866427306*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find the astigmatic transverse ray aberration", "Subsubsection",
 CellChangeTimes->{{3.6969503458175364`*^9, 3.696950352803473*^9}, {
  3.6969656054706497`*^9, 3.696965608222396*^9}, {3.69696989912605*^9, 
  3.696969903546987*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ta", "[", 
   RowBox[{"\[Rho]_", ",", "\[Phi]_"}], "]"}], " ", "=", " ", 
  RowBox[{"T", "[", "Wa", "]"}]}]], "Input",
 CellChangeTimes->{{3.696950284767311*^9, 3.6969503032243032`*^9}, {
   3.696950370001927*^9, 3.696950370110496*^9}, 3.696965936662187*^9, {
   3.696969894530342*^9, 3.696969894590282*^9}, {3.696969927465454*^9, 
   3.6969699275502577`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      SuperscriptBox["H", "4"], " ", "R", " ", "W422", " ", "\[Rho]", " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
     RowBox[{"n", " ", "r"}]]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.696950289329509*^9, 3.696950303504669*^9}, 
   3.696950372629233*^9, 3.696965939277649*^9, 3.69696660543895*^9, {
   3.696966685388742*^9, 3.6969666967601433`*^9}, 3.696971079255848*^9, 
   3.6969712080748463`*^9, 3.696971334240212*^9, 3.6969713736685457`*^9, 
   3.6969829457372427`*^9, 3.696982992818894*^9, {3.696983024820115*^9, 
   3.6969830531672144`*^9}, 3.696983451140918*^9, {3.6969834847737164`*^9, 
   3.69698349986917*^9}, 3.696983742560256*^9, 3.6969839767403383`*^9, 
   3.6969847350588703`*^9, {3.696984827021106*^9, 3.696984851917055*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Solve for where the sum of the spherical and defocus transverse ray \
aberration is zero\
\>", "Subsubsection",
 CellChangeTimes->{{3.696966288251134*^9, 3.696966316093369*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TpB", "[", 
    RowBox[{"\[Rho]_", ",", "\[Phi]_"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"Tdf", "[", 
     RowBox[{"\[Rho]", ",", "\[Phi]"}], "]"}], " ", "+", " ", 
    RowBox[{"Ta", "[", 
     RowBox[{"\[Rho]", ",", "\[Phi]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.696966482582143*^9, 3.696966565240592*^9}, {
  3.696969930427705*^9, 3.696969933945726*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpB", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"TpB", "[", 
      RowBox[{"1", ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "]"}], " ", "\[Equal]", " ", "0"}], ",",
     " ", "W020"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696966318723816*^9, 3.6969663909390078`*^9}, {
  3.696966589544619*^9, 3.696966594941884*^9}, {3.696966922339172*^9, 
  3.696966924693787*^9}, {3.696969938055684*^9, 3.696969950676674*^9}, {
  3.696971169023143*^9, 3.696971173409259*^9}, {3.6969829236056733`*^9, 
  3.696982938182276*^9}, {3.696982974687282*^9, 3.696982974956764*^9}, {
  3.6969830136415668`*^9, 3.6969830468370867`*^9}, {3.696983114766387*^9, 
  3.6969831177015915`*^9}, {3.696983216355978*^9, 3.69698323306608*^9}, {
  3.6969834941885705`*^9, 3.696983495844665*^9}, {3.6969836748006816`*^9, 
  3.696983677963691*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"W020", "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["H", "4"]}], " ", "W422"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.6969829385765314`*^9, 3.6969829457528687`*^9}, {
   3.6969829759435654`*^9, 3.696983053182842*^9}, 3.696983118201949*^9, {
   3.696983222130577*^9, 3.696983233735859*^9}, 3.6969834511721745`*^9, {
   3.6969834847958813`*^9, 3.696983499900423*^9}, 3.6969836782482767`*^9, 
   3.696983742581939*^9, 3.6969839767715807`*^9, 3.6969847350828686`*^9, {
   3.6969848270435514`*^9, 3.696984851945057*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SpB", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{"SpB", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], " ", "/", " ", 
   "2"}]}]], "Input",
 CellChangeTimes->{{3.6969834335553026`*^9, 3.6969834771818805`*^9}, {
  3.6969836944222264`*^9, 3.6969837372194157`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["H", "4"], " ", "W422"}], "2"]}]], "Output",
 CellChangeTimes->{{3.6969834511721745`*^9, 3.696983499900423*^9}, 
   3.696983742597661*^9, 3.6969839767892437`*^9, 3.696984735094897*^9, {
   3.6969848270566583`*^9, 3.696984851957055*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pts", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"TpB", "[", 
      RowBox[{"P\[Rho]", ",", "P\[Phi]"}], "]"}], "/.", 
     RowBox[{"SpB", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"H", " ", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"R", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"W422", "\[Rule]", " ", "1"}], ",", 
      RowBox[{"r", "\[Rule]", "1"}], ",", " ", 
      RowBox[{"n", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"a", "\[Rule]", " ", "0.7"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ptsT", " ", "=", " ", 
  RowBox[{"Transpose", "[", "pts", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"ptsT", ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"PointSize", "[", "Large", "]"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.696879707892838*^9, 3.6968797148248873`*^9}, {
   3.696903092156954*^9, 3.696903147940696*^9}, {3.69690318664925*^9, 
   3.696903190934792*^9}, 3.696907370926317*^9, {3.696966431246517*^9, 
   3.69696643564305*^9}, {3.696966600180306*^9, 3.696966627195345*^9}, 
   3.6969667339983788`*^9, {3.69696680531546*^9, 3.696966808948587*^9}, {
   3.696971067107974*^9, 3.696971068140843*^9}, {3.6969711981495123`*^9, 
   3.696971201828446*^9}, {3.696971279862644*^9, 3.696971303894869*^9}, {
   3.696971348483141*^9, 3.696971369057475*^9}, {3.6969837927793283`*^9, 
   3.696983796370283*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       SqrtBox["2"]], "-", 
      SqrtBox["2"]}], ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       SqrtBox["2"]], "-", 
      SqrtBox["2"]}], ",", 
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], "+", 
      SqrtBox["2"]}], ",", 
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], "+", 
      SqrtBox["2"]}], ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.4949747468305834`"}], ",", "0.4949747468305832`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.4949747468305834`"}], ",", 
     RowBox[{"-", "0.4949747468305832`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.4949747468305834`", ",", 
     RowBox[{"-", "0.4949747468305832`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.4949747468305834`", ",", "0.4949747468305832`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.69696660568458*^9, 3.6969666310397377`*^9}, {
   3.6969666857864037`*^9, 3.6969666971483088`*^9}, 3.696966734413102*^9, 
   3.696966809398321*^9, 3.696971079640429*^9, 3.696971208304223*^9, {
   3.696971292482408*^9, 3.6969713738365183`*^9}, {3.6969829313184557`*^9, 
   3.6969829457684956`*^9}, 3.6969829928501472`*^9, {3.696983024839769*^9, 
   3.696983053329726*^9}, 3.696983451271699*^9, {3.696983484827141*^9, 
   3.696983499919594*^9}, 3.696983742597661*^9, 3.6969837969019833`*^9, 
   3.696983976792755*^9, 3.696984735106867*^9, {3.69698482706868*^9, 
   3.6969848519730587`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[Large], 
     AbsoluteThickness[1.6], 
     PointBox[{{0., 1.}, {-0.7071067811865476, 0.7071067811865476}, {-1., 
      0.}, {-0.7071067811865476, -0.7071067811865476}, {0., -1.}, {
      0.7071067811865476, -0.7071067811865476}, {1., 0.}, {0.7071067811865476,
       0.7071067811865476}, {-0.4949747468305834, 
      0.4949747468305832}, {-0.4949747468305834, -0.4949747468305832}, {
      0.4949747468305834, -0.4949747468305832}, {0.4949747468305834, 
      0.4949747468305832}, {0., 0.}}]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->1,
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{-1., 1.}, {-1., 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.69696660568458*^9, 3.6969666310397377`*^9}, {
   3.6969666857864037`*^9, 3.6969666971483088`*^9}, 3.696966734413102*^9, 
   3.696966809398321*^9, 3.696971079640429*^9, 3.696971208304223*^9, {
   3.696971292482408*^9, 3.6969713738365183`*^9}, {3.6969829313184557`*^9, 
   3.6969829457684956`*^9}, 3.6969829928501472`*^9, {3.696983024839769*^9, 
   3.696983053329726*^9}, 3.696983451271699*^9, {3.696983484827141*^9, 
   3.696983499919594*^9}, 3.696983742597661*^9, 3.6969837969019833`*^9, 
   3.696983976792755*^9, 3.696984735106867*^9, {3.69698482706868*^9, 
   3.6969848520450735`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Part c.", "Subsection",
 CellChangeTimes->{{3.6969843217430797`*^9, 3.696984323703477*^9}}],

Cell[CellGroupData[{

Cell["Solve for where the marginal ray is zero", "Subsubsection",
 CellChangeTimes->{{3.696966288251134*^9, 3.696966316093369*^9}, {
  3.6969845809578876`*^9, 3.696984585646881*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TpC", "[", 
   RowBox[{"\[Rho]_", ",", "\[Phi]_"}], "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{"Tdf", "[", 
    RowBox[{"\[Rho]", ",", "\[Phi]"}], "]"}], " ", "+", " ", 
   RowBox[{"Tc", "[", 
    RowBox[{"\[Rho]", ",", "\[Phi]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.696966482582143*^9, 3.696966565240592*^9}, {
   3.696969930427705*^9, 3.696969933945726*^9}, {3.696984572309783*^9, 
   3.696984572846664*^9}, {3.696984658544591*^9, 3.6969846586447134`*^9}, 
   3.696984789855647*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"H", " ", "R", " ", "W131", " ", 
      SuperscriptBox["\[Rho]", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}]}], ")"}]}], 
     RowBox[{"n", " ", "r"}]], "-", 
    FractionBox[
     RowBox[{"2", " ", "R", " ", "W020", " ", "\[Rho]", " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
     RowBox[{"n", " ", "r"}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", "R", " ", "W020", " ", "\[Rho]", " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], 
      RowBox[{"n", " ", "r"}]]}], "-", 
    FractionBox[
     RowBox[{"2", " ", "H", " ", "R", " ", "W131", " ", 
      SuperscriptBox["\[Rho]", "2"], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
     RowBox[{"n", " ", "r"}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6969847903260956`*^9, {3.6969848271572037`*^9, 3.6969848520570607`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpC", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"TpC", "[", 
      RowBox[{"1", ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "]"}], " ", "\[Equal]", " ", "0"}], ",",
     " ", "W020"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696966318723816*^9, 3.6969663909390078`*^9}, {
  3.696966589544619*^9, 3.696966594941884*^9}, {3.696966922339172*^9, 
  3.696966924693787*^9}, {3.696969938055684*^9, 3.696969950676674*^9}, {
  3.696971169023143*^9, 3.696971173409259*^9}, {3.6969829236056733`*^9, 
  3.696982938182276*^9}, {3.696982974687282*^9, 3.696982974956764*^9}, {
  3.6969830136415668`*^9, 3.6969830468370867`*^9}, {3.696983114766387*^9, 
  3.6969831177015915`*^9}, {3.696983216355978*^9, 3.69698323306608*^9}, {
  3.6969834941885705`*^9, 3.696983495844665*^9}, {3.6969836748006816`*^9, 
  3.696983677963691*^9}, {3.696984665277972*^9, 3.696984679947774*^9}, {
  3.696984844622528*^9, 3.696984847720562*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"W020", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"3", " ", "H", " ", "W131"}], "2"]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.6969829385765314`*^9, 3.6969829457528687`*^9}, {
   3.6969829759435654`*^9, 3.696983053182842*^9}, 3.696983118201949*^9, {
   3.696983222130577*^9, 3.696983233735859*^9}, 3.6969834511721745`*^9, {
   3.6969834847958813`*^9, 3.696983499900423*^9}, 3.6969836782482767`*^9, 
   3.696983742581939*^9, 3.6969839767715807`*^9, 3.6969847352427177`*^9, {
   3.6969848272212024`*^9, 3.696984852069069*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SpC", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{"SpC", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], " ", "/", " ", 
   "2"}]}]], "Input",
 CellChangeTimes->{{3.6969834335553026`*^9, 3.6969834771818805`*^9}, {
  3.6969836944222264`*^9, 3.6969837372194157`*^9}, {3.6969846835399313`*^9, 
  3.696984688089161*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"3", " ", "H", " ", "W131"}], "4"]}]], "Output",
 CellChangeTimes->{{3.6969834511721745`*^9, 3.696983499900423*^9}, 
   3.696983742597661*^9, 3.6969839767892437`*^9, 3.696984735294744*^9, {
   3.696984827273155*^9, 3.696984852081573*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pts", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"TpC", "[", 
      RowBox[{"P\[Rho]", ",", "P\[Phi]"}], "]"}], "/.", 
     RowBox[{"SpC", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"H", " ", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"R", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"W131", "\[Rule]", " ", "1"}], ",", 
      RowBox[{"r", "\[Rule]", "1"}], ",", " ", 
      RowBox[{"n", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"a", "\[Rule]", " ", "0.7"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptsT", " ", "=", " ", 
   RowBox[{"Transpose", "[", "pts", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"ptsT", ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"PointSize", "[", "Large", "]"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", 
    RowBox[{"2", "/", "4.5"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.696879707892838*^9, 3.6968797148248873`*^9}, {
   3.696903092156954*^9, 3.696903147940696*^9}, {3.69690318664925*^9, 
   3.696903190934792*^9}, 3.696907370926317*^9, {3.696966431246517*^9, 
   3.69696643564305*^9}, {3.696966600180306*^9, 3.696966627195345*^9}, 
   3.6969667339983788`*^9, {3.69696680531546*^9, 3.696966808948587*^9}, {
   3.696971067107974*^9, 3.696971068140843*^9}, {3.6969711981495123`*^9, 
   3.696971201828446*^9}, {3.696971279862644*^9, 3.696971303894869*^9}, {
   3.696971348483141*^9, 3.696971369057475*^9}, {3.6969837927793283`*^9, 
   3.696983796370283*^9}, 3.696984542079406*^9, {3.6969846970994997`*^9, 
   3.696984721217221*^9}, {3.696984878059846*^9, 3.696984881796083*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[Large], 
     AbsoluteThickness[1.6], 
     PointBox[{{-1., 1.5}, {-0.9393398282201787, 0.06066017177982129}, {-1.5, 
      0.}, {-0.9393398282201787, -0.06066017177982129}, {-1., -1.5}, \
{-3.0606601717798214`, -2.0606601717798214`}, {-4.5, 
      0.}, {-3.0606601717798214`, 
      2.0606601717798214`}, {-0.23753787975412521`, 
      0.2524621202458747}, {-0.23753787975412521`, -0.2524621202458747}, \
{-1.7224621202458745`, -1.2324621202458745`}, {-1.7224621202458745`, 
      1.2324621202458745`}, {0., 0.}}]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->0.4444444444444444,
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{-4.5, 0}, {-2.0606601717798214`, 2.0606601717798214`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.69696660568458*^9, 3.6969666310397377`*^9}, {
   3.6969666857864037`*^9, 3.6969666971483088`*^9}, 3.696966734413102*^9, 
   3.696966809398321*^9, 3.696971079640429*^9, 3.696971208304223*^9, {
   3.696971292482408*^9, 3.6969713738365183`*^9}, {3.6969829313184557`*^9, 
   3.6969829457684956`*^9}, 3.6969829928501472`*^9, {3.696983024839769*^9, 
   3.696983053329726*^9}, 3.696983451271699*^9, {3.696983484827141*^9, 
   3.696983499919594*^9}, 3.696983742597661*^9, 3.6969837969019833`*^9, 
   3.696983976792755*^9, 3.696984542528133*^9, 3.696984735682682*^9, {
   3.6969848276695232`*^9, 3.6969848521255894`*^9}, 3.6969848823644276`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1500, 957},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.1 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"ReverseColor.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 139, 5, 192, "Chapter"],
Cell[CellGroupData[{
Cell[744, 31, 196, 3, 78, "Section"],
Cell[943, 36, 143, 2, 33, "Input"],
Cell[CellGroupData[{
Cell[1111, 42, 135, 1, 43, "Subsubsection"],
Cell[1249, 45, 309, 7, 33, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1595, 57, 154, 2, 43, "Subsubsection"],
Cell[1752, 61, 1583, 45, 115, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3372, 111, 273, 5, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[3670, 120, 567, 11, 33, "Input"],
Cell[4240, 133, 1823, 37, 59, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6112, 176, 139, 1, 43, "Subsubsection"],
Cell[6254, 179, 1415, 43, 56, "Input"],
Cell[CellGroupData[{
Cell[7694, 226, 757, 19, 78, "Input"],
Cell[8454, 247, 1589, 52, 47, "Output"],
Cell[10046, 301, 2110, 53, 410, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12205, 360, 168, 3, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[12398, 367, 1194, 28, 78, "Input"],
Cell[13595, 397, 2187, 48, 149, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15843, 452, 94, 1, 78, "Section"],
Cell[CellGroupData[{
Cell[15962, 457, 343, 5, 43, "Subsubsection"],
Cell[16308, 464, 229, 6, 33, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16574, 475, 180, 2, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[16779, 481, 272, 6, 33, "Input"],
Cell[17054, 489, 966, 21, 48, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18069, 516, 94, 1, 53, "Subsection"],
Cell[CellGroupData[{
Cell[18188, 521, 248, 4, 43, "Subsubsection"],
Cell[18439, 527, 204, 5, 33, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18680, 537, 188, 2, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[18893, 543, 293, 6, 33, "Input"],
Cell[19189, 551, 1049, 22, 50, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20287, 579, 187, 4, 43, "Subsubsection"],
Cell[20477, 585, 380, 10, 33, "Input"],
Cell[20860, 597, 472, 11, 33, "Input"],
Cell[CellGroupData[{
Cell[21357, 612, 103, 3, 33, "Input"],
Cell[21463, 617, 506, 9, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22006, 631, 1418, 32, 78, "Input"],
Cell[23427, 665, 2329, 49, 412, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25817, 721, 95, 1, 53, "Subsection"],
Cell[CellGroupData[{
Cell[25937, 726, 149, 2, 43, "Subsubsection"],
Cell[26089, 730, 409, 10, 33, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26535, 745, 237, 3, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[26797, 752, 395, 8, 33, "Input"],
Cell[27195, 762, 860, 16, 50, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28104, 784, 187, 4, 43, "Subsubsection"],
Cell[28294, 790, 429, 11, 33, "Input"],
Cell[CellGroupData[{
Cell[28748, 805, 873, 17, 33, "Input"],
Cell[29624, 824, 603, 12, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30264, 841, 400, 11, 33, "Input"],
Cell[30667, 854, 311, 7, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31015, 866, 1537, 33, 78, "Input"],
Cell[32555, 901, 2295, 72, 95, "Output"],
Cell[34853, 975, 2292, 48, 410, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37206, 1030, 97, 1, 53, "Subsection"],
Cell[CellGroupData[{
Cell[37328, 1035, 182, 2, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[37535, 1041, 529, 12, 33, "Input"],
Cell[38067, 1055, 1076, 30, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39180, 1090, 968, 18, 33, "Input"],
Cell[40151, 1110, 610, 12, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40798, 1127, 451, 12, 33, "Input"],
Cell[41252, 1141, 293, 6, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41582, 1152, 1703, 36, 78, "Input"],
Cell[43288, 1190, 2414, 49, 193, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

